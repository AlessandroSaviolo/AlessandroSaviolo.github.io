---
title: ""
permalink: /PI-TCN/
author_profile: true
---

<head>
<style>
.aligncenter {
  text-align: center;
}
p.title {
  text-align: center;
  font-weight: bold;
  font-size: 30px;
}
p.description {
  text-align: justify;
}

.column {
  float: left;
  width: 50%;
  padding: 5px;
}
.row::after {
  content: "";
  clear: both;
  display: table;
}

figure {
  text-align: center;
  margin-top: 72px;
  margin-bottom: 72px;
  display: block;
}
figcaption {
  text-align: center;
  font-style: italic;
  padding: 2px;
}
</style>
</head>

<p class="title">Physics-Inspired Temporal Learning of Quadrotor Dynamics for Accurate Model Predictive Trajectory Tracking</p>

<p class="aligncenter"><a href="https://alessandrosaviolo.github.io/">Alessandro Saviolo</a>, <a href="https://lguanrui.github.io/">Guanrui Li</a>, <a href="https://scholar.google.it/citations?user=W8f0d6oAAAAJ&hl=en">Giuseppe Loianno</a></p>

<p class="aligncenter">
  <a href="https://arxiv.org/abs/2206.03305">Paper</a> 
  <a href="https://youtu.be/O3fkwmNwL9E">Video</a>
</p>

<figure>
<img src="/images/pitcn_1.jpg" alt="Long-exposure photo showing multiple laps over Lemniscate trajectory when using the nominal (NOM) and the proposed (PI-TCN) dynamics." style="width:100%">
<figcaption>Figure 1. Long-exposure photo showing multiple laps over Lemniscate trajectory when using the nominal (NOM) and the proposed (PI-TCN) dynamics. The reference trajectory (white) is approximately projected on the image based on real-world experiments for illustrative purposes.</figcaption>
</figure>

<p class="description"><b>Abstract.</b> Accurately modeling quadrotor's system dynamics is critical for guaranteeing agile, safe, and stable navigation. The model needs to capture the system behavior in multiple flight regimes and operating conditions, including those producing highly nonlinear effects such as aerodynamic forces and torques, rotor interactions, or possible system configuration modifications. Classical approaches rely on handcrafted models and struggle to generalize and scale to capture these effects. In this paper, we present a novel Physics-Inspired Temporal Convolutional Network (PI-TCN) approach to learning quadrotor's system dynamics purely from robot experience. Our approach combines the expressive power of sparse temporal convolutions and dense feed-forward connections to make accurate system predictions. In addition, physics constraints are embedded in the training process to facilitate the network's generalization capabilities to data outside the training distribution. Finally, we design a model predictive control approach that incorporates the learned dynamics for accurate closed-loop trajectory tracking fully exploiting the learned model predictions in a receding horizon fashion. Experimental results demonstrate that our approach accurately extracts the structure of the quadrotor's dynamics from data, capturing effects that would remain hidden to classical approaches. To the best of our knowledge, this is the first time physics-inspired deep learning is successfully applied to temporal convolutional networks and to the system identification task, while concurrently enabling predictive control.</p>

<figure>
  <img src="/images/autotune_2.gif" alt="Quadrotor trajectory tracking." style="width:100%">
  <figcaption>Figure 2. Quadrotor trajectory tracking. The captured data is used to train PI-TCN to model the quadrotor's system dynamics in self-supervised fashion.</figcaption>
</figure>

## Introduction

<p class="description">Unmanned aerial vehicles (UAVs), such as quadrotors, have become important platforms to help humans solve a wide range of time-sensitive problems including logistics, search and rescue for post-disaster response, and more recently reconnaissance and monitoring during the COVID-19 pandemic. These tasks often require robots to make fast decisions and agile maneuvers in uncertain, cluttered, and dynamic environments. In these scenarios, to safely control a UAV, it is critical to accurately model the system dynamics to capture the highly nonlinear effects generated by aerodynamic forces and torques, propellers interactions, vibrations, and other phenomena. However, such effects cannot be easily measured or modeled, thus remain hidden. Moreover, for some UAV applications, the platform may be extended with external payloads that would significantly change the dynamics by varying the mass and moment of inertia. Overall, failing to model such system changes would result in significant degradation of the flight performance and may cause catastrophic failures.</p>

<p class="description"><b>Related Work.</b> Classic modeling of the quadrotor's dynamics is performed using physics-based principles approaches which result in nonlinear ordinary differential equations. However, these nominal models only approximate the actual system dynamics and do not take into account external effects caused by aggressive maneuvers or system modifications. To circumvent this issue, recent works have investigated data-driven approaches for modeling system dynamics. Several methodologies exist, from combining nominal models with learned residual terms to fully predicting the system dynamics using neural networks.</p>

<b>Contributions.</b>

<ul style="list-style-type:square">
<p class="description">

<li>We design and present PI-TCN for learning quadrotor dynamics. To date, this is the first time physics-inspired learning is applied to temporal convolutional networks since most of the approaches have only focused on feed-forward and recurrent neural networks;</li>
<li>We perform an extensive evaluation by comparing the predictive performance of the proposed methodology against nominal, residual, and learning methods on unseen test maneuvers in both simulation and real-world settings. We experimentally validate the network's design choices and propose several ablation studies to evaluate their roles in capturing quadrotor's dynamics from data, even highly nonlinear effects that remain hidden to classical and residual approaches.;</li>
<li>We propose a model predictive control framework that leverages the learned dynamical model and we extensively test it to track multiple aggressive maneuvers.</li>

</p>
</ul>
